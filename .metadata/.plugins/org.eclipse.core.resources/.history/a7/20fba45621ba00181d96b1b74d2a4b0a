package com.jacob.dao;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.context.annotation.Bean;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.test.context.junit4.SpringRunner;
import static org.assertj.core.api.Assertions.*;
import com.jacob.model.Blog;

@RunWith(SpringRunner.class)
@WebMvcTest(BlogDAO.class)
public class BlogDAOTest {

	@Bean(name = "dataSource")
	public javax.sql.DataSource dataSource() {
	       DriverManagerDataSource driverManagerDataSource = new DriverManagerDataSource();
           driverManagerDataSource.setDriverClassName("com.mysql.jdbc.Driver");
           driverManagerDataSource.setUrl("jdbc:mysql://localhost:3306/springBlogDb?useLegacyDatetimeCode=false&serverTimezone=UTC&useSSL=false");
           driverManagerDataSource.setUsername("root");
           driverManagerDataSource.setPassword("baseball");
               return driverManagerDataSource;
           }
	}
	
   @Autowired
    private BlogDAO blogDao;
 
   @Before
	public void before() {
		System.out.println("Before");
	}
	
	@Test
	public void getBlogTest() {
		
		System.out.println("Test ran?");
		Blog expected = new Blog(20, 40, "tom", "green"); 

		Blog actual = blogDao.getBlog(20);
		
		assertThat(expected.getTitle())
		.isEqualTo(actual.getTitle());
	}

	@After
	public void after() {
		System.out.println("After");
	}
}
